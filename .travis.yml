sudo: required
services:
  - docker

language: java

jdk:
- openjdk8
- openjdk10

env:
  matrix:
  - COVERAGE=0.5 TARGET=ui
  - COVERAGE=0.5 TARGET=service/cart
  - COVERAGE=0.5 TARGET=service/user
  - COVERAGE=0.35 TARGET=repository/order
  - COVERAGE=0.5 TARGET=repository/cart
  - COVERAGE=0.5 TARGET=repository/product
  - COVERAGE=0.3 TARGET=repository/user

  global:
  - secure: UxQK+9dYhIg07XKd6Mq+nasFAY0h462+rGAS2tBdyHCMYVmKZz99B8cKRbhJZiu2osu8bprNur8EZPybAA/T5W2iAIysqxzsoOoREgrDmJ++tLkr3dZOM4Ywrd+MoqvPtuHzmXraoLUO7HI6RwydzvaeOKw++JkuVK/3kDj2zPPGPWs90lm1sVJat+aPNr/vn2S37eWgGo3JTKtfng3qCWTx6A2niROtX0VvOdQmS2E2QhRCd0ZLuwJ1wKqaWcW5aCjgwayBlDnsTnFYRaGTf7GLqLhFGPcrvCG/FboD9zeaK0a4Ow3EV/GR61pUmVXwmJTA+2PUXUGbJ+iCV5Woa3Z7tnzAA1MXYfTw6YsIKGykukIcj+X0aN3CyEDCrCbDXMcXPYUbidfFJlPzI5PJDKmEig3mArhlqRLNe5F5MKOTjyYpHuIZoXiHqvz2xaNefiALzsF7OLeSdTJtHjgatd2NNirBJtWODRuB3mDPxoJ+T37pa5jmdDTlZByc6olAjsM4Iq+1R6QNHQdxt+LoazL7JHPzkKDw6WdCJ8nQYkW8/jJ5QIHrFhyDmJutlaP7NQtgg38KnY0GQz85NmVe4yWFc4P4rfGwQJeyig7fdyXqDdherMHNZXXwXiDfPk6q8N2JOHnLkB/9jUWihq2kDC6HbTkMJbczYO9v4TjtDh4=
  - secure: EPV64PlJNTp+Rpft8FZ2VrWlGhpJRIoMr48HJW58CxIHc5e7nPn4j453oHmqg1cnoNquOSr4NC6Gk2jkzMkgOB8QjjN/L/XZv4Cn0q6/n67Jmn60asBL4azuyr8jmOnMeEs4TE0WPaGRaxXPQIrPgCjavObn6YLsjwxO29apf8MRH7u53epPq48qHXD/iOEUwBo0szc8VIQgd3pvaNV6Yn//XvgHTTF5RPOU6O9uiCM7uCkhQ6e9TNamuu1n6Lwkg3YdGJJfP3MS4qiBExVpm+7f4ar6vgMgOh84SF1AL2m3XP0oz1iYUt5S8fcv/qrkSGDAyQcp7DrZtRpKcQ5nO+ixisEsR49FGg54cX5kBUhjiXEv+/WhWJclDdYfVVCx2+qpeTOlWfNUJ4OdSSbR1dpEuAUSXaXsSVy/Vy2kSvjO0YX23ZOsPgQC/oHVZd9xUfdrqBoX065S9eEpv/QDWBvNq5xvwkOT1XUuxk5HqSFgFQZcQKrdHzDqm1soTq/tJo74f6oEBLlN2bHPLpI3UW6kAeHJQZ6gY/gaeAlm2tZk+AuSMfe3PZ9OPBHhHgCQlZwOIUr1cZkh4ergd3rnOf6dUC+FFpKveWYm7b9UiYEjXPBkJrLGjzTM47zSjKh+mJCLRxVekXYP8TozDdpbfm8Ie73wyaCPqp8u8kq7AEE=

install:
- "./gradlew clean jar"

script:
- COVERAGE=${COVERAGE} ./gradlew -p ./monolithic/$TARGET check

deploy:
- provider: script
  script: bash -c "echo \"${DOCKER_PASSWORD}" | docker login --username \"${DOCKER_LOGIN}\" --password-stdin"
  # on:
  #   all_branches: true